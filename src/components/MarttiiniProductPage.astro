---
import MarttiiniPicture from "./MarttiiniPicture.astro";
import type { FullMarttiiniProduct } from "../libs/marttiini";
import { useTranslations } from "../i18n/utils";

interface Props {
  product: FullMarttiiniProduct;
  lang: 'en' | 'pl';
}

const { product, lang } = Astro.props;
const t = useTranslations(lang);

// Get main image
const mainImage = product.cdn_images[0];
---

<article class="container py-4">
  <div class="row g-4">
    <!-- Product Images -->
    <div class="col-lg-6">
      <div class="sticky-top" style="top: 2rem;">
        {product.cdn_images.length > 0 && (
          <div class="" style="aspect-ratio: 1;">
            <MarttiiniPicture
              src={mainImage}
              alt={product.name}
              place="details-page"
            />
          </div>
        )}
      </div>
    </div>

    <!-- Product Info -->
    <div class="col-lg-6">
      <h1 class="display-5 fw-bold mb-3">{product.name}</h1>
      
      <div class="d-flex gap-2 flex-wrap mb-3">
        <span class="badge bg-light text-dark">SKU: {product.sku}</span>
        <span class="badge bg-light text-dark">{product.category}</span>
      </div>

      {product.lead && (
        <div class="mb-4">
          <p class="fs-5 text-secondary">{product.lead}</p>
        </div>
      )}

      {product.description && (
        <div class="mb-4">
          <h2 class="h4 mb-3">Description</h2>
          <div class="lh-lg" set:html={product.description} />
        </div>
      )}

      {product.attributes && product.attributes.length > 0 && (
        <div class="mb-4">
          <h2 class="h4 mb-3">Specifications</h2>
          {product.attributes.map((group) => (
            <div class="mb-4">
              <h3 class="h5 fw-semibold mb-2">{group.name}</h3>
              <dl class="row g-2">
                {group.properties.map((prop) => (
                  <>
                    <dt class="col-sm-4 fw-medium text-secondary">{prop.name}</dt>
                    <dd class="col-sm-8">{prop.value}</dd>
                  </>
                ))}
              </dl>
            </div>
          ))}
        </div>
      )}
    </div>
  </div>
</article>
