---
import Layout from "../../../layouts/Layout.astro";
import ManufacturerPage from "../../../layouts/ManufacturerPage.astro";
import { categoryRepository, manufacturerRepository } from "../../../content";
import { getOwnerStory } from "../../../content/site.repository";

export async function getStaticPaths() {
  return [
    { params: { lang: "en", manufacturer: "marttiini" } },
    { params: { lang: "pl", manufacturer: "marttiini" } }
  ];
}

const { lang, manufacturer } = Astro.params;
const manufacturerData = await manufacturerRepository.get(manufacturer, lang);
const allCategories = await categoryRepository.findCategories(lang);
const manufacturerCategories = allCategories.filter((c) => c.manufacturer === manufacturer);
const ownerStory = getOwnerStory(manufacturer, lang);
---

<Layout title={manufacturerData.name} lang={lang}>
  <ManufacturerPage 
    manufacturer={manufacturerData}
    categories={manufacturerCategories}
    ownerStory={ownerStory}
  />
</Layout>