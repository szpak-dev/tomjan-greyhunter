---
import Layout from "../../../layouts/Layout.astro";
import ManufacturerPage from "../../../layouts/ManufacturerPage.astro";
import { categoryRepository, manufacturerRepository, siteRepository } from "../../../content";

export async function getStaticPaths() {
  return [
    { params: { lang: "en", manufacturer: "marttiini" } },
    { params: { lang: "pl", manufacturer: "marttiini" } }
  ];
}

const { lang, manufacturer } = Astro.params;
const manufacturerData = await manufacturerRepository.get(manufacturer, lang);
const allCategories = await categoryRepository.findCategories(lang);
const manufacturerCategories = allCategories.filter((c) => c.manufacturer === manufacturer);
const ownerStory = siteRepository.getOwnerStory(manufacturer, lang);
const socials = siteRepository.getSocialAccounts();
const owner = siteRepository.getSiteOwner();
const languages = siteRepository.getAvailableLanguages();
const currentLanguage = siteRepository.getLanguage(lang);
const navigationItems = siteRepository.getNavigationItems(lang);
---

<Layout title={manufacturerData.name} {lang} {socials} {owner} {languages} {currentLanguage} {navigationItems}>
  <ManufacturerPage 
    manufacturer={manufacturerData}
    categories={manufacturerCategories}
    ownerStory={ownerStory}
  />
</Layout>