---
import PromotedProductsSlider from "../../components/PromotedProductsSlider.astro";
import NewInOffer from "../../components/NewInOffer.astro";
import OfficialDistributorGrid from "../../components/OfficialDistributorGrid.astro";
import FrontPageSection from "../../components/FrontPageSection.astro";

import Layout from "../../layouts/Layout.astro";
import { languages } from "../../i18n/ui";
import { useTranslations } from "../../i18n/utils";

import { productRepository, manufacturerRepository, miscRepository, categoryRepository } from "../../content";
import PassionMossaicGrid from "../../components/PassionMossaicGrid.astro";
const lang = Astro.currentLocale as string;
const t = useTranslations(lang as keyof typeof languages);

const sliderProductIds = ["marttiini.aapa", "marttiini.bear-knife"];
const promotedProducts = await productRepository.getPromotedProducts(sliderProductIds, lang);

const newProductIds = ["marttiini.aapa", "marttiini.bear-knife"];
const newProducts = await productRepository.getNewProducts(newProductIds, lang);

const imagesOrientationMap = await manufacturerRepository.getImagesOrientationMap(lang);
const manufacturers = await manufacturerRepository.findManufacturers(lang);
const mossaicPictures = miscRepository.findMossaicPictures();

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({ params: { lang } }));
}
---

<Layout title="Home">
  <PromotedProductsSlider 
    promotedProducts={promotedProducts} 
    imagesOrientationMap={imagesOrientationMap}  
  />
  
  <FrontPageSection heading={t('headings.official-distributor')}>
    <OfficialDistributorGrid 
      manufacturers={manufacturers} 
      ordering={["marttiini", "sarsilmaz", "eley-hawk", "eley"]} 
    />
  </FrontPageSection>

  <FrontPageSection heading={t('headings.new-in-offer')}>
    <NewInOffer 
      products={newProducts} 
      lang={lang} 
    />
  </FrontPageSection>

  <FrontPageSection heading={t('headings.passion')}>
    <PassionMossaicGrid 
      mossaicPictures={mossaicPictures} 
    />
  </FrontPageSection>
</Layout>
