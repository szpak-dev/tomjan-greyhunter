---
import PromotedProductsSlider from "../../components/PromotedProductsSlider.astro";
import NewInOffer from "../../components/NewInOffer.astro";
import OfficialDistributorGrid from "../../components/OfficialDistributorGrid.astro";

import Layout from "../../layouts/Layout.astro";
import { languages } from "../../i18n/ui";

import { productRepository, manufacturerRepository } from "../../content";
const lang = Astro.currentLocale as string;

const sliderProductIds = ["marttiini.aapa", "marttiini.bear-knife"];
const promotedProducts = await productRepository.getPromotedProducts(sliderProductIds, lang);

const newProductIds = ["marttiini.aapa", "marttiini.bear-knife"];
const newProducts = await productRepository.getNewProducts(newProductIds, lang);

const imagesOrientationMap = await manufacturerRepository.getImagesOrientationMap(lang);
const manufacturers = await manufacturerRepository.findManufacturers(lang);

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({ params: { lang } }));
}
---

<Layout title="Home">
  <PromotedProductsSlider 
    promotedProducts={promotedProducts} 
    imagesOrientationMap={imagesOrientationMap}  
  />

  <OfficialDistributorGrid 
    manufacturers={manufacturers} 
    ordering={["marttiini", "sarsilmaz", "eley-hawk", "eley"]} 
  />

  <NewInOffer 
    products={newProducts} 
    lang={lang} 
  />
</Layout>
