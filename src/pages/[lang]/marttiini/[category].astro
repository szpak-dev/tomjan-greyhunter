---
import Layout from "../../../layouts/Layout.astro";
import ProductsGrid from "../../../components/ProductsGrid.astro";

import { categoryRepository, productRepository } from "../../../content";
import { languages } from "../../../i18n/ui";
const { lang, category } = Astro.params;

const categoryData = await categoryRepository.getCategoryBySlug("marttiini", category, lang);
const products = await productRepository.findProductsByCategory("marttiini", category, lang);

export async function getStaticPaths() {
  const paths = [];

  for (const lang of Object.keys(languages)) {
    const categories = await categoryRepository.findCategoriesWithImages("marttiini", lang as "en" | "pl" );

    for (const category of categories) {
      paths.push({
        params: {
          lang,
          category: category.slug,
        },
      });
    }
  }

  return paths;
}

const pageTitle = `${category} - Marttiini`;
---

<Layout title={pageTitle}>
    <ProductsGrid
      products={products}
      lang={lang as string}
      categoryName={categoryData.name}
  />
</Layout>

