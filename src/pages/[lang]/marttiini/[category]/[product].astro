---
import Layout from "../../../../layouts/Layout.astro";
import { languages } from "../../../../i18n/ui";
import { useTranslations } from "../../../../i18n/utils";
import { productRepository } from "../../../../content";

import ProductPage from "../../../../components/ProductPage.astro";

export async function getStaticPaths() {
  const paths = [];

  for (const lang of Object.keys(languages)) {
    const products = await productRepository.findProducts("marttiini", lang);
    for (const product of products) {
      paths.push({
        params: {
          lang,
          category: product.category_slug,
          product: product.slug,
        },
      });
    }
  }

  return paths;
}

const { lang, product } = Astro.params;
const t = useTranslations(lang as "en" | "pl");

const prod = await productRepository.getProductById( `marttiini.${product}`, lang );
const pageTitle = `${prod.name} - Marttiini`;
---

<Layout title={pageTitle}>
  <ProductPage product={prod} lang={lang as "en" | "pl"} />
</Layout>
